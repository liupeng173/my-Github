<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>抽奖</title>
		<style>
			body {
				font-family: "微软雅黑";
			}
			.wp {
				width: 450px;
				height: 450px;
				margin: 0 auto;
			}
			.bg {
				width: 400px;
				height: 400px;
				background-image: url(img/cj.gif);
				position: relative;
			}
			.bg-in {
				width: 340px;
				height: 340px;
				background-image: url(img/xx.png);
				position: absolute;
				top: 30px;
				left: 30px;
			}
			#playBtn {
				width: 186px;
				height: 186px;
				background-image: url(img/dj.png);
				position: absolute;
				top: 77px;
				left: 77px;
			}
		</style>
	</head>
	<body>
		
		<div class="wp">
			<h2>您已拥有<span id="times">0</span>次抽奖机会，点击立刻抽奖！~</h2>
			<div class="bg">
				<div class="bg-in">
					<a id="playBtn" href="javascript:;"></a>
				</div>
			</div>
		</div>
		
		<script src="../../../case/lesson02.jquery/js/jQueryv1.11.3.js"></script>
		<script src="js/jquery.rotate.min.js"></script>
		<script>

			!function(window ,document ,$ ,unedfinde) {
				var flag = false, times = 1,
					$this ,date ,num , angle ,msgArr;
				
				$('#times').html(times);
				$('#playBtn').on('click', function(){
					
					if (flag || times == 0){//flag = false时不执行、次数为零时不执行
						if(times == 0){
							alert('没有次数了！！')
						}
						return;
					}
					flag = true;
					$this = $(this);
			  		date = [1 ,2 ,3 ,4, ,5 ,6];
			  		num = date[Math.floor(Math.random() * date.length)];
			  		msgArr = [
			  			null,
			  			'恭喜您获得2000元理财金!',
			  			'谢谢参与~再来一次吧~',
			  			'恭喜您获得5200元理财金',
			  			'恭喜您获得100元京东E卡，将在次日以短信形式下发到您的手机上，请注意查收!',
			  			'谢谢参与~再来一次吧~',
			  			'恭喜您获得1000元理财金!'
			  		];
			  		angle = num * 60 - 60;//角度
			  		rotateIt(angle ,msgArr[num] , $this);
				  	});
				  	
				  	var rotateIt = function(angle ,msg , $btn){
				  		console.log(arguments)
				  		
						$btn.rotate({
							duration:6000,
							angle: 0,
						    center: ["50%", "50%"],
						    animateTo:angle + 360 * 5,
						    callback: function(){//动画执行完之后执行
						    	flag = false;
						    	alert(msg);
						    	$btn.rotate(0);//执行之后指针自动回原处
						    	times--;//减次数
						    	$('#times').html(times);
						    }
						});
						
					};
			}(window ,document ,jQuery);
		</script>
	</body>
</html>
